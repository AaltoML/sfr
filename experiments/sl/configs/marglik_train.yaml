defaults:
  - inference_strategy: laplace
  # Use slurm on cluster or local?
  # - override hydra/launcher: submitit_local
  - override hydra/launcher: lumi
  # Disable logging by Hydra
  # - override hydra/job_logging: none # stop hydra creating .log file
  # - override hydra/hydra_logging: none # saves .hydra/*.yaml files
  - _self_

# Config dataset and NN from Immer et al 2021
dataset: "MNIST"
model_name: "SmallMLP"
# debug: True
debug: False

device: "gpu"
output_dim: ???
batch_size: 512
lr: 1e-4
n_epochs: 500
double: False

num_epochs_burnin: 40
marglik_frequency: 10
num_hypersteps: 10
lr_hyp: 1e-4
prior_prec_init: 0.0008
temperature: 1.0

logging_epoch_freq: 10
random_seed: 117

sfr:
  _target_: experiments.sl.utils.init_SFR_with_gaussian_prior
  _convert_: all
  # network: ???
  delta: 1e-4
  likelihood:
    _target_: src.likelihoods.CategoricalLh
    EPS: 0.0 # TODO default is 0.01
  output_dim: ${output_dim}
  num_inducing: 128
  dual_batch_size: 1000
  jitter: 1e-4
  device: ${device} # TODO should this always be cpu??

wandb:
  group: ${dataset}
  project: "sfr-sl"
  use_wandb: True
  run_name: ml-delta=${sfr.delta}-lr=${lr}-seed=${random_seed}-${now:%Y-%m-%d_%H-%M-%S}
  tags:
    - "delta=${sfr.delta}"
    - "dataset=${dataset}"
    - "marglik"

hydra:
  run:
    dir: output/${hydra.job.name}/${now:%Y-%m-%d_%H-%M-%S}
  job:
    chdir: true
  sweep:
    dir: ${hydra.run.dir}
    subdir: ${hydra.job.num}
  job_logging:
    root:
      level: INFO # DEBUG
